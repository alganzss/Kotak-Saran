function doPost(e) {
  try {
    // ID Google Sheets Anda - ganti dengan ID yang sebenarnya
    const SHEET_ID = 'MASUKKAN_ID_GOOGLE_SHEETS_ANDA';
    const sheet = SpreadsheetApp.openById(SHEET_ID).getActiveSheet();
    
    // Ambil data dari form
    const timestamp = e.parameter.timestamp || new Date().toLocaleString('id-ID');
    const name = e.parameter.name || 'Anonim';
    const email = e.parameter.email || 'Tidak disediakan';
    const category = e.parameter.category || 'Tidak dipilih';
    const suggestion = e.parameter.suggestion || '';
    
    // Tambahkan header jika sheet kosong
    if (sheet.getLastRow() === 0) {
      sheet.getRange(1, 1, 1, 5).setValues([
        ['Timestamp', 'Nama', 'Email', 'Kategori', 'Saran']
      ]);
      
      // Format header
      const headerRange = sheet.getRange(1, 1, 1, 5);
      headerRange.setFontWeight('bold');
      headerRange.setBackground('#667eea');
      headerRange.setFontColor('white');
    }
    
    // Tambahkan data baru
    sheet.appendRow([timestamp, name, email, category, suggestion]);
    
    // Auto resize columns
    sheet.autoResizeColumns(1, 5);
    
    return ContentService
      .createTextOutput('Success')
      .setMimeType(ContentService.MimeType.TEXT);
      
  } catch (error) {
    return ContentService
      .createTextOutput('Error: ' + error.toString())
      .setMimeType(ContentService.MimeType.TEXT);
  }
}

// Tambahkan fungsi doGet untuk mengatasi CORS
function doGet() {
  return ContentService
    .createTextOutput('Web app is running')
    .setMimeType(ContentService.MimeType.TEXT);
}

